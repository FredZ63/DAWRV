<!DOCTYPE html>
<html>
<head>
    <title>Test ElevenLabs API Key</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #1e1e2e;
            color: #fff;
        }
        input, button {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #667eea;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 14px;
        }
        button {
            background: #667eea;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background: #5568d3;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            color: #4CAF50;
        }
        .error {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
            color: #f44336;
        }
        .info {
            background: rgba(102, 126, 234, 0.2);
            border: 1px solid #667eea;
            color: #667eea;
        }
        pre {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üîë ElevenLabs API Key Tester</h1>
    <p>This will test if your ElevenLabs API key is valid.</p>
    
    <input type="password" id="apiKey" placeholder="Paste your ElevenLabs API key here (sk_...)">
    <button onclick="testKey()">Test API Key</button>
    
    <div id="result"></div>
    
    <script>
        async function testKey() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!apiKey) {
                showResult('error', '‚ùå Please enter an API key');
                return;
            }
            
            if (!apiKey.startsWith('sk_')) {
                showResult('error', '‚ùå Invalid key format. ElevenLabs keys start with "sk_"');
                return;
            }
            
            showResult('info', 'üîÑ Testing API key...');
            
            try {
                // Test 1: Fetch voices
                const response = await fetch('https://api.elevenlabs.io/v1/voices', {
                    headers: {
                        'xi-api-key': apiKey
                    }
                });
                
                if (response.status === 401) {
                    showResult('error', `
                        ‚ùå <strong>API Key is INVALID (401 Unauthorized)</strong><br><br>
                        <strong>This means:</strong><br>
                        ‚Ä¢ The key is incorrect (typo when copying?)<br>
                        ‚Ä¢ The key was revoked<br>
                        ‚Ä¢ The key doesn't have permission<br><br>
                        <strong>What to do:</strong><br>
                        1. Go to: <a href="https://elevenlabs.io/app/settings/api-keys" target="_blank" style="color: #667eea;">ElevenLabs API Keys</a><br>
                        2. Delete ALL old keys<br>
                        3. Generate a brand NEW key<br>
                        4. Copy it carefully (no spaces or extra characters)<br>
                        5. Test again
                    `);
                    return;
                }
                
                if (response.status === 403) {
                    showResult('error', `
                        ‚ùå <strong>API Key doesn't have permission (403 Forbidden)</strong><br><br>
                        Check your ElevenLabs account status.
                    `);
                    return;
                }
                
                if (response.status === 429) {
                    showResult('error', `
                        ‚ö†Ô∏è <strong>Rate limit exceeded (429)</strong><br><br>
                        Wait a few seconds and try again.
                    `);
                    return;
                }
                
                if (!response.ok) {
                    showResult('error', `
                        ‚ùå <strong>API Error: ${response.status}</strong><br><br>
                        Unexpected error from ElevenLabs API.
                    `);
                    return;
                }
                
                const data = await response.json();
                
                if (!data.voices || data.voices.length === 0) {
                    showResult('error', '‚ùå No voices found in your account');
                    return;
                }
                
                // Success!
                const voiceList = data.voices.map(v => `‚Ä¢ ${v.name} (${v.voice_id})`).join('<br>');
                
                showResult('success', `
                    ‚úÖ <strong>API KEY IS VALID!</strong> üéâ<br><br>
                    <strong>Found ${data.voices.length} voices:</strong><br>
                    ${voiceList}<br><br>
                    <strong>Key format:</strong> ${apiKey.substring(0, 10)}...${apiKey.slice(-4)}<br><br>
                    ‚úÖ <strong>This key WILL WORK in DAWRV!</strong><br><br>
                    <strong>Next step:</strong><br>
                    Copy this EXACT key and paste it into DAWRV Voice Settings.
                `);
                
            } catch (error) {
                showResult('error', `
                    ‚ùå <strong>Network Error</strong><br><br>
                    ${error.message}<br><br>
                    Check your internet connection.
                `);
            }
        }
        
        function showResult(type, message) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = type;
            resultDiv.innerHTML = message;
            resultDiv.style.display = 'block';
        }
        
        // Allow Enter key
        document.getElementById('apiKey').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                testKey();
            }
        });
    </script>
</body>
</html>

